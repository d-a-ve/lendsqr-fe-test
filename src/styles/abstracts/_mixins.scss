// ==========================================================================
// Mixins
// ==========================================================================

@use 'sass:map';
@use 'sass:list';
@use 'variables' as *;
@use 'functions' as *;

// --------------------------------------------------------------------------
// Responsive (Mobile-First)
// --------------------------------------------------------------------------

/// Media query mixin for responsive design (mobile-first / min-width)
/// @param {String} $breakpoint - Breakpoint name (sm, md, lg, xl, xxl)
/// @content Styles to apply at this breakpoint and above
@mixin respond-to($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    $value: map.get($breakpoints, $breakpoint);

    @if $value == 0 {
      @content;
    } @else {
      @media (min-width: $value) {
        @content;
      }
    }
  } @else {
    @error "Unknown breakpoint: #{$breakpoint}. Available: #{map.keys($breakpoints)}";
  }
}

/// Media query for max-width (use sparingly, prefer mobile-first)
/// @param {String} $breakpoint - Breakpoint name
/// @content Styles to apply below this breakpoint
@mixin respond-below($breakpoint) {
  @if map.has-key($breakpoints, $breakpoint) {
    $value: map.get($breakpoints, $breakpoint);

    @if $value > 0 {
      @media (max-width: ($value - 0.02px)) {
        @content;
      }
    }
  } @else {
    @error "Unknown breakpoint: #{$breakpoint}. Available: #{map.keys($breakpoints)}";
  }
}

// --------------------------------------------------------------------------
// Typography
// --------------------------------------------------------------------------

/// Apply font size with matching line height from the scale
/// @param {String} $size - Size name (xs, sm, base, lg, xl, 2xl, 3xl, 4xl, 5xl)
@mixin text-size($size) {
  font-size: font-size($size);
  line-height: line-height($size);
}

/// Truncate text with ellipsis
@mixin truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/// Multi-line text truncation with ellipsis
/// @param {Number} $lines - Number of lines to show before truncating
@mixin line-clamp($lines) {
  display: -webkit-box;
  -webkit-line-clamp: $lines;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/// Apply smooth font rendering
@mixin font-smoothing {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

// --------------------------------------------------------------------------
// Layout
// --------------------------------------------------------------------------

/// Flexbox centering (both axes)
@mixin flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

/// Flexbox with space-between
@mixin flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/// Flexbox column
@mixin flex-column {
  display: flex;
  flex-direction: column;
}

/// Inline flexbox centering
@mixin inline-flex-center {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

/// Maintain aspect ratio
/// @param {Number} $width - Width ratio
/// @param {Number} $height - Height ratio
@mixin aspect-ratio($width, $height) {
  aspect-ratio: #{$width} / #{$height};
}

/// Full viewport cover
@mixin cover-viewport {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
}

/// Absolute centering
@mixin absolute-center {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

// --------------------------------------------------------------------------
// Utilities
// --------------------------------------------------------------------------

/// Visually hidden but accessible to screen readers
@mixin visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/// Reset button styles
@mixin reset-button {
  appearance: none;
  background: none;
  border: none;
  padding: 0;
  margin: 0;
  font: inherit;
  color: inherit;
  cursor: pointer;

  &:focus {
    outline: none;
  }
}

/// Reset list styles
@mixin reset-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

/// Reset anchor styles
@mixin reset-link {
  color: inherit;
  text-decoration: none;

  &:hover,
  &:focus {
    text-decoration: none;
  }
}

/// Focus visible outline (accessible focus state)
/// @param {Color} $color - Outline color
/// @param {Number} $offset [2px] - Outline offset
@mixin focus-ring($color: $primary-500, $offset: 2px) {
  &:focus-visible {
    outline: 2px solid $color;
    outline-offset: $offset;
  }
}

/// Hide scrollbar but keep functionality
@mixin hide-scrollbar {
  -ms-overflow-style: none;
  scrollbar-width: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

// --------------------------------------------------------------------------
// Transitions
// --------------------------------------------------------------------------

/// Apply standard transition
/// @param {List} $properties - Properties to transition
/// @param {Time} $duration [$transition-base] - Transition duration
/// @param {String} $timing [ease] - Timing function
@mixin transition(
  $properties: all,
  $duration: $transition-base,
  $timing: ease
) {
  $transitions: ();

  @each $property in $properties {
    $transitions: list.append($transitions, $property $duration $timing, comma);
  }

  transition: $transitions;
}

// --------------------------------------------------------------------------
// Pseudo Elements
// --------------------------------------------------------------------------

/// Create pseudo element base styles
/// @param {String} $content [''] - Content value
@mixin pseudo($content: '') {
  content: $content;
  display: block;
}

/// Overlay pseudo element
/// @param {Color} $color [rgba(0, 0, 0, 0.5)] - Overlay color
@mixin overlay($color: rgba(0, 0, 0, 0.5)) {
  position: relative;

  &::after {
    @include pseudo;
    position: absolute;
    inset: 0;
    background-color: $color;
    pointer-events: none;
  }
}
